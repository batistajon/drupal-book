#!/bin/sh

echo "$TRAVIS_PULL_REQUEST_BRANCH"
echo "Commit message: ${TRAVIS_COMMIT_MESSAGE}"

JIRA_TICKET=`echo "$TRAVIS_PULL_REQUEST_BRANCH" | grep -o '[A-Z]\+-[0-9]\+'`
echo "${JIRA_TICKET}"

TICKET_STATUS=`curl -u $JIRA_USER_NAME:$JIRA_API_TOKEN -X GET -H "Content-Type: application/json" "https://beckeredu.atlassian.net/rest/api/3/issue/${JIRA_TICKET}" | jq '.fields.status.id'`
echo "${TICKET_STATUS}"